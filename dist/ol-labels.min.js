ol.control.LabelDebug=function(e){var t=e||{};void 0!==t.className&&t.className;this.state={open:!1,isDemoModeRunning:!1},this.btn=document.createElement("button"),this.btn.className="menu-toggle-button",this.buttonIcon={openMenu:">_",closeMenu:"X"},this.btn.innerHTML=this.buttonIcon.openMenu;var n=this;this.btn.addEventListener("click",function(e){n.toggleMenu()}),this.container=document.createElement("div"),this.container.className="ol-label-debug ol-control ol-collapsed",this.menu=document.createElement("div"),this.menu.className="",this.container.appendChild(this.btn),this.container.appendChild(this.menu),ol.control.Control.call(this,{element:this.container,target:t.target})},ol.inherits(ol.control.LabelDebug,ol.control.Control),ol.control.LabelDebug.prototype.toggleMenu=function(){!0===this.state.open?this.closeMenu():this.openMenu(),this.state.open=!this.state.open},ol.control.LabelDebug.prototype.openMenu=function(){this.btn.innerHTML=this.buttonIcon.closeMenu,this.menu.style.display="",0==this.menu.innerHTML.length&&this.renderMenuContents()},ol.control.LabelDebug.prototype.closeMenu=function(){this.btn.innerHTML=this.buttonIcon.openMenu,this.menu.style.display="none"},ol.control.LabelDebug.prototype.renderMenuContents=function(){var e=this.getMap(),t={width:"300px"},n=document.createElement("div");Object.assign(n.style,{margin:"10px"});var a=n.cloneNode(),o=document.createElement("input");o.setAttribute("type","checkbox"),o.id="drawCirclesCheckbox";var i=document.createElement("label");i.htmlFor="drawCirclesCheckbox",i.appendChild(o),i.appendChild(document.createTextNode("Draw circles around the labels.")),a.appendChild(i),o.addEventListener("change",function(e){g.toggleDrawCircles_(e)}),window.debugDrawCirc=!1;var l=n.cloneNode(),r=document.createElement("input");Object.assign(r.style,t),r.setAttribute("type","range"),r.setAttribute("id","labelfactorRange"),r.setAttribute("min","0.0"),r.setAttribute("max","3.0"),r.setAttribute("step","0.1"),r.defaultValue="1.1";var s=document.createElement("label");s.id="sliderLabel",s.htmlFor="labelfactorRange",s.appendChild(document.createTextNode("Set the coefficient of the labelFactor. (1.1)")),l.appendChild(s),l.appendChild(document.createElement("br")),l.appendChild(r),r.addEventListener("input",function(e){g.changeLabelFactor_(e)}),window.labelFacCoeff=1.1;var c=n.cloneNode(),d=document.createElement("input");Object.assign(d.style,t),d.setAttribute("type","range"),d.setAttribute("id","minTFactorRange"),d.setAttribute("min","0.0"),d.setAttribute("max","20"),d.setAttribute("step","0.1"),d.defaultValue="9";var u=document.createElement("label");u.id="minTLabel",u.htmlFor="minTFactorRange",u.appendChild(document.createTextNode("Set the offset for the calculation of the min_t. (9)")),d.addEventListener("input",function(e){g.changeMinTFactor_(e)}),c.appendChild(u),c.appendChild(document.createElement("br")),c.appendChild(d),window.minTFac=9;var h=n.cloneNode(),p=document.createElement("input");Object.assign(p.style,t),p.setAttribute("type","range"),p.setAttribute("id","minTCoeffRange"),p.setAttribute("min","0.0"),p.setAttribute("max","5"),p.setAttribute("step","0.1"),p.defaultValue="1.0";var m=document.createElement("label");m.id="minTCoeffLabel",m.htmlFor="minTCoeffRange",m.appendChild(document.createTextNode("Set the coefficient for the calculation of the min_t. (1.0)"));var g=this;p.addEventListener("input",function(e){g.changeMinTCoeff_(e)}),h.appendChild(m),h.appendChild(document.createElement("br")),h.appendChild(p),window.minTCoeff=1;var b=n.cloneNode(),v=document.createElement("input");Object.assign(v.style,{"margin-left":"10px",width:"50px"}),v.setAttribute("type","number"),v.setAttribute("id","zoomLevelDelta"),v.setAttribute("min","0.0"),v.setAttribute("max","10.0"),v.setAttribute("step","0.1"),v.setAttribute("value","1.0");var f=document.createElement("input");Object.assign(f.style,{width:"600px","margin-top":"10px"}),f.setAttribute("type","range"),f.setAttribute("id","zoomSliderInput"),f.setAttribute("min",0),f.setAttribute("max",28),f.setAttribute("step",v.value),f.defaultValue=e.getView().getZoom();var y=document.createElement("label");y.id="zoomSliderLabel",y.htmlFor="zoomSliderInput",y.appendChild(document.createTextNode("Use the slider to change the zoom level with the defined zoom delta:"));var L=document.createElement("label");Object.assign(L.style,{"margin-left":"10px",position:"relative",top:"-6px"}),L.id="zoomLevelLabel",L.htmlFor="zoomLevelLabel",L.appendChild(document.createTextNode("zoom: "+e.getView().getZoom())),v.addEventListener("input",function(){f.setAttribute("step",v.value)}),f.addEventListener("input",function(){document.getElementById("zoomLevelLabel").innerHTML="zoom: "+f.value,e.getView().setZoom(f.value)}),e.on("moveend",function(t){var n=e.getView().getZoom();n=Math.round(1e3*n)/1e3,document.getElementById("zoomLevelLabel").innerHTML="zoom: "+n,document.getElementById("zoomSliderInput").value=n}),b.appendChild(y),b.appendChild(v),b.appendChild(document.createElement("br")),b.appendChild(f),b.appendChild(L);var C=n.cloneNode(),M=document.createElement("button");M.className="demo-mode-button",M.id="demoModeControlBtn",M.innerHTML="&#9658";var T=document.createElement("label");T.id="demoModeControlLabel",T.htmlFor="demoModeControlBtn",T.innerHTML="Demo mode: ",M.addEventListener("click",function(){w.state.isDemoModeRunning?(M.innerHTML="&#9658;",w.stopDemoMode_()):(M.innerHTML="&#10074;&#10074;",w.startDemoMode_());w.state.isDemoModeRunning=!w.state.isDemoModeRunning});var w=this;C.appendChild(T),C.appendChild(M);var E=document.createElement("div");E.appendChild(a),E.appendChild(l),E.appendChild(c),E.appendChild(h),E.appendChild(b),E.appendChild(C),this.menu.appendChild(E),resolutionToMinT=this.resolutionToMinT,calculateLabelFactor=this.calculateLabelFactor},ol.control.LabelDebug.prototype.toggleDrawCircles_=function(e){e.preventDefault(),window.debugDrawCirc=document.getElementById("drawCirclesCheckbox").checked,this.updateLabelLayer_()},ol.control.LabelDebug.prototype.changeLabelFactor_=function(e){e.preventDefault();var t=document.getElementById("labelfactorRange");document.getElementById("sliderLabel").innerHTML="Set the coefficient of the labelFactor. ("+t.value+")",window.labelFacCoeff=t.value,this.updateLabelLayer_()},ol.control.LabelDebug.prototype.changeMinTFactor_=function(e){e.preventDefault();var t=document.getElementById("minTFactorRange");document.getElementById("minTLabel").innerHTML="Set the offset for the calculation of the min_t. ("+t.value+")",window.minTFac=t.value,this.updateLabelLayer_()},ol.control.LabelDebug.prototype.changeMinTCoeff_=function(e){e.preventDefault();var t=document.getElementById("minTCoeffRange");document.getElementById("minTCoeffLabel").innerHTML="Set the coefficient for the calculation of the min_t. ("+t.value+")",window.minTCoeff=t.value,this.updateLabelLayer_()},ol.control.LabelDebug.prototype.updateLabelLayer_=function(){this.getMap().getLayers().forEach(function(e){e instanceof ol.layer.Label&&e.getSource().refresh()})},ol.control.LabelDebug.prototype.resolutionToMinT=function(e){var t=Math.log2(156543.03390625)-Math.log2(e);return t<=3?1e4:window.minTCoeff*Math.pow(2,window.minTFac-(t-1))},ol.control.LabelDebug.prototype.calculateLabelFactor=function(e){var t=e.get("lbl_fac");return parseInt(t)*window.labelFacCoeff},ol.control.LabelDebug.prototype.startDemoMode_=function(){var e=this,t=this.getMap().getView(),n=(t.getRotation(),t.getCenter()),a=3e3,o=Math.round(6*Math.random())+4;a*=Math.abs(14-o);var i,l,r,s,c=(i=[8,12],l=[48,54],r=Math.random()*(i[1]-i[0]+1)+i[0],s=Math.random()*(l[1]-l[0]+1)+l[0],ol.proj.fromLonLat([r,s])),d=(Math.round(100*new ol.geom.LineString([n,c]).getLength()),Math.random()*(2*Math.PI));t.animate({center:c,duration:2*a,rotation:d},function(){setTimeout(function(){e.state.isDemoModeRunning&&e.startDemoMode_()},1)}),t.animate({zoom:o,duration:a},{zoom:14,duration:a})},ol.control.LabelDebug.prototype.stopDemoMode_=function(){var e=this.getMap().getView();e.setResolution(e.getResolution())};const TypedMap=Map;var ol;!function(e){e.resolutionToMinT=function(e){var t=Math.log2(156543.03390625)-Math.log2(e);return t<=3?1e4:Math.pow(2,9-(t-1))}}(ol||(ol={})),function(e){e.control||(e.control={})}(ol||(ol={})),function(e){!function(t){t.LayerMenu=class extends e.control.Control{constructor(t){var n=document.createElement("div");super({element:n,target:(t=t||{}).target}),this.container=n,this.menu=document.createElement("div"),this.menu.className="layer-menu",this.btn=document.createElement("button"),this.btn.innerHTML="&#9776;";var a=this;this.btn.addEventListener("click",function(){a.toggleMenu()}),n.className="ol-layer-menu ol-control ol-collapsed",n.appendChild(this.menu),n.appendChild(this.btn),this.state={open:!1,layers:new e.Collection}}toggleMenu(){!0===this.state.open?this.closeMenu():this.openMenu(),this.state.open=!this.state.open}activateLayerLabel(t){var n=t.target;if(null!=n.value){var a=n.value;n.checked,this.state.layers.getArray().filter(t=>t instanceof e.layer.Label).forEach(e=>{e.get("title")===a?e.setVisible(!0):e.setVisible(!1)})}}activateLayer(t){var n=t.target;if(void 0!==n.value){var a=n.value;n.checked,this.state.layers.getArray().filter(t=>!(t instanceof e.layer.Label)).forEach(e=>{e.get("title")===a?e.setVisible(!0):e.setVisible(!1)})}}openMenu(){this.getMap().getLayers(),this.btn.innerHTML="X",this.container.classList.remove("ol-collapsed"),""==this.menu.innerHTML&&this.renderMenuContents()}closeMenu(){this.getMap().getLayers(),this.container.classList.add("ol-collapsed"),this.btn.innerHTML="&#9776;"}renderMenuContents(){var t=document.createElement("div");t.innerHTML="<h5>Tiles</h5>";var n=document.createElement("ul");this.state.layers=this.getMap().getLayers(),this.state.layers.forEach(function(t,a,o){if(!(t instanceof e.layer.Label||null==t.get("title"))){var i=t.get("title"),l=t.getVisible(),r=document.createElement("li");r.setAttribute("title",t.get("description"));var s=document.createElement("label"),c=document.createElement("input");c.setAttribute("type","radio"),c.setAttribute("name","tiles"),c.setAttribute("value",i),c.checked=l,s.appendChild(c);var d=document.createElement("span");d.innerHTML=i,s.appendChild(d),r.appendChild(s),n.appendChild(r)}}),t.appendChild(n),this.menu.appendChild(t);var a=this;t.addEventListener("click",function(e){a.activateLayer(e)});var o=document.createElement("div");o.innerHTML="<h5>Labels</h5>";var i=document.createElement("ul");this.state.layers.forEach(function(t,n){if(t instanceof e.layer.Label&&null!=t.get("title")){var a=t.get("title"),o=t.getVisible(),l=document.createElement("li"),r=document.createElement("label"),s=document.createElement("input");s.setAttribute("type","radio"),s.setAttribute("name","labels"),s.setAttribute("value",a),s.checked=o,r.appendChild(s);var c=document.createElement("span");c.innerHTML=a,r.appendChild(c),l.appendChild(r),i.appendChild(l)}}),o.appendChild(i),this.menu.appendChild(o),o.addEventListener("click",function(e){a.activateLayerLabel(e)})}}}(e.control||(e.control={}))}(ol||(ol={})),function(e){!function(t){t.Label=class extends e.layer.Vector{constructor(t){t.style||(t.style=e.style.labelStyle),void 0===t.updateWhileAnimating&&(t.updateWhileAnimating=!0),void 0===t.updateWhileInteracting&&(t.updateWhileInteracting=!0),super(t)}}}(e.layer||(e.layer={}))}(ol||(ol={})),function(e){!function(t){class n extends t.Vector{constructor(t){var a=t.url.toString(),o=n.createFeatureLoader(a);t.format=new e.format.GeoJSON,t.strategy=e.loadingstrategy.bbox,t.url=o,super(t),this.labelServerUrl=a,this.featureLoader=o}static createFeatureLoader(t){return(a,o,i)=>{var l=e.proj.toLonLat(a.slice(0,2)),r=e.proj.toLonLat(a.slice(2,4)),s=e.resolutionToMinT(o),c={x_min:l[0],x_max:r[0],y_min:l[1],y_max:r[1],t_min:s};return n.buildQuery(t,c)}}static buildQuery(e,t){void 0!==t&&"object"==typeof t||(t={});var n="?",a=0;for(var o in t){a++;var i=o,l=t[o];n+=1==a?i+"="+l:"&"+i+"="+l}return e+n}}t.Label=n}(e.source||(e.source={}))}(ol||(ol={})),function(e){let t;!function(e){e[e.ICON=0]="ICON",e[e.TEXT=1]="TEXT"}(t||(t={}));const n=new TypedMap([["aboriginal","buddhist.svg"],["administration","town_hall.svg"],["airport","aerodrome.12.svg"],["artgallery","artwork.svg"],["assortment","buddhist.svg"],["atm","atm.svg"],["bank","bank.svg"],["bar","bar.svg"],["bbq","picnic.svg"],["beergarden","biergarten.svg"],["bicycle_shop","shop/bicycle.svg"],["boat","buddhist.svg"],["breastfeeding","buddhist.svg"],["bus","bus_stop.12.svg"],["cafeteria","shop/coffee.svg"],["car","shop/car.svg"],["car_share","rental_car.svg"],["casino","buddhist.svg"],["catholicgrave","grave_yard_christian.svg"],["church","christian.svg"],["cinema","cinema.svg"],["clock","buddhist.svg"],["coffee","shop/coffee.svg"],["communitycentre","community_centre.svg"],["congress","town_hall.svg"],["court","courthouse.svg"],["dance_class","buddhist.svg"],["dancinghall","buddhist.svg"],["daycare","buddhist.svg"],["dentist","dentist.svg"],["drinkingfountain","fountain.svg"],["e-bike-charging","charging_station.svg"],["fast_food","fast_food.svg"],["ferry","ferry.svg"],["fillingstation","fuel.svg"],["firemen","firestation.svg"],["firstaid","buddhist.svg"],["fountain","fountain.svg"],["hospital","hospital.svg"],["ice_cream","shop/ice_cream.svg"],["library","library.svg"],["market","shop/supermarket.svg"],["medicalstore","pharmacy.svg"],["medicine","pharmacy.svg"],["music_classical","shop/musical_instrument.svg"],["nursing_home_icon","buddhist.svg"],["parking","parking.svg"],["parking_bicycle","bicycle_parking.svg"],["perfumery","shop/perfumery.svg"],["police","police.svg"],["postal","post_office.svg"],["restaurant","restaurant.svg"],["sauna","buddhist.svg"],["school","buddhist.svg"],["spa","buddhist.svg"],["stripclub","buddhist.svg"],["taxi","taxi.svg"],["telephone","telephone.svg"],["theatre","theatre.svg"],["toilets","toilets.svg"],["tools","buddhist.svg"],["trash","waste_basket.10.svg"],["undefined","buddhist.svg"],["university","buddhist.svg"],["veterinary","veterinary.svg"],["waiting","bench.svg"],["wifi","buddhist.svg"],["workoffice","buddhist.svg"]]),a="https://rawgit.com/gravitystorm/openstreetmap-carto/master/symbols/";class o{constructor(t,n){this.text=t.get("name"),this.feature=t,this.t=t.get("t"),this.factor=t.get("lbl_fac"),this.resolveType(),this.min_t=e.resolutionToMinT(n)}resolveType(){if(this.text.includes("icon:")){this.type=t.ICON;var e=this.text.replace("icon:","");this.iconUrl=o.getIconURL(e)}else this.type=t.TEXT}render(){var n=null;if(this.min_t>this.t)return null;if(this.type==t.ICON){const t=this.text;void 0===o.iconCache.get(t)?(n=new e.style.Style({image:new e.style.Icon({crossOrigin:"anonymous",src:this.iconUrl})}),o.iconCache.set(t,n)):n=o.iconCache.get(t)}else if(this.type==t.TEXT){var a=window.debugDrawCirc?this.text+":debug":this.text;if(void 0===o.textCache.get(a)){var i=this.calculateLabelFactor(),l=i+"px Consolas";this.text.indexOf("\\")>=0&&(this.text=this.text.replace("\\n","\n"));var r=i*o.getMaxLabelLength(this.text)*.26,s=new e.style.Circle({radius:r,stroke:new e.style.Stroke({color:"red"})}),c=new e.style.Text({text:this.text,font:l,stroke:new e.style.Stroke({color:"#333",width:4}),fill:new e.style.Fill({color:"#fff"})});n=new e.style.Style({image:1==window.debugDrawCirc?s:null,text:c}),o.textCache.set(a,n)}else n=o.textCache.get(a)}return n}static getIconURL(e){let t=n.get("undefined");return void 0!==n.get(e)&&(t=n.get(e)),a+t}calculateLabelFactor(){var e=this.feature.get("lbl_fac");return 1.1*parseInt(e)}static getMaxLabelLength(e){for(var t=e.split("\n"),n=0,a=t.length,o=0;o<a;o++)n<t[o].length&&(n=t[o].length);return n}}o.iconCache=new TypedMap,o.textCache=new TypedMap,e.Label=o}(ol||(ol={})),function(e){!function(t){t.labelStyle=function(t,n){return new e.Label(t,n).render()}}(e.style||(e.style={}))}(ol||(ol={}));